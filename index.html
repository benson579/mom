<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>佳士多旅遊總監 - 名片分享</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- 引入 LINE LIFF SDK -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f0f2f5; }
        .line-bg { background-color: #9bb0be; } 
        .flex-bubble {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 320px;
        }
        /* Loading 遮罩 */
        #loading {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; z-index: 9999; display: flex;
            justify-content: center; align-items: center; transition: opacity 0.5s;
        }
    </style>
</head>
<body class="h-screen flex flex-col items-center justify-center bg-gray-100">

    <!-- Loading Screen -->
    <div id="loading">
        <div class="text-center">
            <i class="fas fa-spinner fa-spin text-4xl text-[#2c3e50]"></i>
            <p class="mt-4 text-gray-500 font-bold">名片載入中...</p>
        </div>
    </div>

    <!-- Main Container -->
    <div class="relative w-full max-w-[375px] h-full sm:h-[750px] bg-[#9bb0be] sm:rounded-[3rem] sm:border-8 sm:border-gray-800 overflow-hidden flex flex-col shadow-2xl">
        
        <!-- Header (Mock) -->
        <div class="mt-0 sm:mt-8 h-14 bg-[#2c3e50] flex items-center px-4 z-10 shadow-sm shrink-0">
            <span class="ml-2 text-white font-bold text-lg">名片預覽與分享</span>
        </div>

        <!-- Scrollable Content Area -->
        <div class="flex-1 overflow-y-auto p-4 flex flex-col items-center gap-4 scrollbar-hide">
            
            <div class="w-full flex justify-center my-2">
                <span class="bg-[rgba(0,0,0,0.2)] text-white text-xs px-3 py-1 rounded-full">預覽</span>
            </div>

            <!-- === THE FLEX CARD === -->
            <div class="bg-white rounded-xl overflow-hidden flex-bubble w-full shrink-0">
                
                <!-- HERO IMAGE -->
                <div class="relative w-full h-44">
                    <img src="https://i.postimg.cc/2StGJdPr/8DBF6C7B-90B7-491F-8CFB-B5156FD87732.jpg" class="w-full h-full object-cover" style="object-position: top;">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"></div>
                    <div class="absolute bottom-3 left-3 text-white">
                        <p class="text-xs font-light opacity-90">帶您看見世界的美</p>
                        <h2 class="text-xl font-bold tracking-wide">佳士多旅遊總監</h2>
                    </div>
                </div>

                <!-- BODY -->
                <div class="p-4 pt-3">
                    <div class="flex justify-between items-baseline mb-2">
                        <h1 class="text-[#2c3e50] font-bold text-base">全方位旅遊 x 生活選物</h1>
                        <span class="text-[#E67E22] text-[10px] font-bold bg-[#FFF0E0] px-2 py-1 rounded">20年資歷</span>
                    </div>
                    
                    <p class="text-[#555] text-xs leading-relaxed mb-4">
                        整合三大旅行社資源，為您打造最完美的旅程。懂玩、懂吃、懂生活。
                    </p>

                    <div class="w-full border-t border-dashed border-gray-300 mb-4"></div>

                    <!-- Info List -->
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="w-8 flex justify-center mt-1 mr-2"><i class="fas fa-plane text-[#3498DB] text-sm"></i></div>
                            <div class="flex-1">
                                <p class="text-gray-400 text-[10px] font-bold uppercase">專業職人</p>
                                <p class="text-[#2c3e50] text-sm font-bold">佳士多旅行社 業務總監</p>
                                <p class="text-[#666] text-xs">山富旅行社 資深領隊導遊</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="w-8 flex justify-center mt-1 mr-2"><i class="fas fa-handshake text-[#2ECC71] text-sm"></i></div>
                            <div class="flex-1">
                                <p class="text-gray-400 text-[10px] font-bold uppercase">在地深耕</p>
                                <p class="text-[#2c3e50] text-sm font-bold">愛旅遊 中部合作夥伴</p>
                                <p class="text-[#666] text-xs">客製化行程規劃專家</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="w-8 flex justify-center mt-1 mr-2"><i class="fas fa-heart text-[#E74C3C] text-sm"></i></div>
                            <div class="flex-1">
                                <p class="text-gray-400 text-[10px] font-bold uppercase">生活風格</p>
                                <p class="text-[#E74C3C] text-sm font-bold">百萬團購主 (FB社團)</p>
                                <p class="text-[#666] text-xs">分享旅行與生活中的美好事物</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FOOTER BUTTONS -->
                <div class="p-4 pt-0 grid grid-cols-2 gap-2">
                    <a href="https://line.me/ti/p/FaXuuoOYal" class="col-span-1 bg-[#06C755] hover:opacity-90 text-white font-bold py-2.5 rounded-lg text-xs flex items-center justify-center gap-1 shadow-sm no-underline">
                        <i class="fab fa-line"></i> 諮詢行程
                    </a>
                    <a href="https://www.facebook.com/share/17GC8EFYAD/?mibextid=wwXIfr" class="col-span-1 bg-[#1877F2] hover:opacity-90 text-white font-bold py-2.5 rounded-lg text-xs flex items-center justify-center gap-1 shadow-sm no-underline">
                        <i class="fab fa-facebook-f"></i> 逛逛團購
                    </a>
                    
                    <!-- SHARE BUTTON (Trigger) -->
                    <button id="btnShare" onclick="sendShare()" class="col-span-2 bg-gray-800 text-white font-bold py-3 rounded-lg text-sm hover:bg-black flex items-center justify-center gap-2 mt-2 shadow-md transition transform active:scale-95">
                        <i class="fas fa-paper-plane"></i> 分享名片給好友
                    </button>
                </div>
            </div>

            <p class="text-white text-xs opacity-70 mt-4 text-center px-4">
                點擊上方黑色按鈕，即可將此名片發送給您的 LINE 好友。
            </p>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // ==========================================
        // 1. 設定區域 (請填入您的資訊)
        // ==========================================
        // 申請 LIFF ID 的網址: https://developers.line.biz/
        // 請確保開啟 "ShareTargetPicker" 功能
        const YOUR_LIFF_ID = "2008788337-c00C9UGS"; 

        // ==========================================
        // 2. Flex Message 資料內容
        // ==========================================
        const flexMessage = {
            "type": "bubble",
            "hero": {
                "type": "image",
                "url": "https://i.postimg.cc/2StGJdPr/8DBF6C7B-90B7-491F-8CFB-B5156FD87732.jpg",
                "size": "full",
                "aspectRatio": "20:13",
                "aspectMode": "cover",
                "action": { "type": "uri", "uri": "https://line.me/ti/p/FaXuuoOYal" }
            },
            "body": {
                "type": "box", "layout": "vertical",
                "contents": [
                    { "type": "text", "text": "佳士多旅遊總監", "weight": "bold", "size": "xl", "color": "#ffffff", "position": "absolute", "offsetBottom": "15px", "offsetLeft": "15px", "shadow": true },
                    { "type": "text", "text": "帶您看見世界的美", "size": "xs", "color": "#ffffffcc", "position": "absolute", "offsetBottom": "40px", "offsetLeft": "15px" },
                    {
                        "type": "box", "layout": "baseline", "margin": "md",
                        "contents": [
                            { "type": "text", "text": "全方位旅遊 x 生活選物", "weight": "bold", "size": "md", "color": "#2c3e50", "flex": 1 },
                            { "type": "text", "text": "20年資歷", "size": "xxs", "color": "#E67E22", "weight": "bold", "flex": 0, "backgroundColor": "#FFF0E0", "paddingAll": "xs", "cornerRadius": "sm" }
                        ]
                    },
                    { "type": "text", "text": "整合三大旅行社資源，為您打造最完美的旅程。懂玩、懂吃、懂生活。", "size": "xs", "color": "#555555", "wrap": true, "margin": "md" },
                    { "type": "separator", "margin": "lg" },
                    {
                        "type": "box", "layout": "vertical", "margin": "lg", "spacing": "md",
                        "contents": [
                            { "type": "box", "layout": "horizontal", "spacing": "md", "contents": [ { "type": "icon", "url": "https://cdn-icons-png.flaticon.com/512/723/723955.png", "size": "sm", "offsetTop": "xs" }, { "type": "box", "layout": "vertical", "contents": [ { "type": "text", "text": "專業職人", "size": "xxs", "color": "#aaaaaa", "weight": "bold" }, { "type": "text", "text": "佳士多旅行社 業務總監", "size": "sm", "color": "#2c3e50", "weight": "bold", "wrap": true }, { "type": "text", "text": "山富旅行社 資深領隊導遊", "size": "xs", "color": "#666666", "wrap": true } ] } ] },
                            { "type": "box", "layout": "horizontal", "spacing": "md", "contents": [ { "type": "icon", "url": "https://cdn-icons-png.flaticon.com/512/1256/1256650.png", "size": "sm", "offsetTop": "xs" }, { "type": "box", "layout": "vertical", "contents": [ { "type": "text", "text": "在地深耕", "size": "xxs", "color": "#aaaaaa", "weight": "bold" }, { "type": "text", "text": "愛旅遊 中部合作夥伴", "size": "sm", "color": "#2c3e50", "weight": "bold", "wrap": true }, { "type": "text", "text": "客製化行程規劃專家", "size": "xs", "color": "#666666", "wrap": true } ] } ] },
                            { "type": "box", "layout": "horizontal", "spacing": "md", "contents": [ { "type": "icon", "url": "https://cdn-icons-png.flaticon.com/512/2921/2921226.png", "size": "sm", "offsetTop": "xs" }, { "type": "box", "layout": "vertical", "contents": [ { "type": "text", "text": "生活風格", "size": "xxs", "color": "#aaaaaa", "weight": "bold" }, { "type": "text", "text": "百萬團購主 (FB社團)", "size": "sm", "color": "#E74C3C", "weight": "bold", "wrap": true }, { "type": "text", "text": "分享旅行與生活中的美好事物", "size": "xs", "color": "#666666", "wrap": true } ] } ] }
                        ]
                    }
                ]
            },
            "footer": {
                "type": "box", "layout": "vertical", "spacing": "sm",
                "contents": [
                    {
                        "type": "box", "layout": "horizontal", "spacing": "sm",
                        "contents": [
                            { "type": "button", "style": "primary", "height": "sm", "action": { "type": "uri", "label": "諮詢行程", "uri": "https://line.me/ti/p/FaXuuoOYal" }, "color": "#06C755", "flex": 1 },
                            { "type": "button", "style": "primary", "height": "sm", "action": { "type": "uri", "label": "逛逛團購", "uri": "https://www.facebook.com/share/17GC8EFYAD/?mibextid=wwXIfr" }, "color": "#1877F2", "flex": 1 }
                        ]
                    },
                    { "type": "button", "style": "secondary", "height": "sm", "action": { "type": "uri", "label": "分享名片給好友", "uri": "https://line.me/R/nv/recommendOA/@LineID" }, "color": "#F1F3F4" }
                ]
            }
        };

        // ==========================================
        // 3. 初始化與分享邏輯
        // ==========================================
        
        // 頁面載入後執行初始化
        window.onload = function() {
            const loading = document.getElementById('loading');
            
            // 模擬預覽環境 (若沒有填寫 LIFF ID)
            if (!YOUR_LIFF_ID) {
                setTimeout(() => { loading.style.opacity = 0; setTimeout(()=>loading.remove(), 500); }, 1000);
                console.log("預覽模式：未填寫 LIFF ID");
                return;
            }

            // 初始化 LIFF
            liff.init({ liffId: YOUR_LIFF_ID })
                .then(() => {
                    console.log("LIFF 初始化成功");
                    if (!liff.isLoggedIn()) {
                        liff.login();
                    }
                    loading.style.opacity = 0;
                    setTimeout(()=>loading.remove(), 500);
                })
                .catch((err) => {
                    console.error("LIFF 初始化失敗:", err);
                    alert("LIFF 初始化失敗，請檢查 ID 是否正確，或確認網址是否已在 LINE Developers 登記為 Endpoint URL。");
                    loading.style.opacity = 0;
                    setTimeout(()=>loading.remove(), 500);
                });
        };

        // 發送名片函式
        async function sendShare() {
            // 1. 檢查是否有填寫 ID (基本的 ID 檢查)
            if (!YOUR_LIFF_ID) {
                alert("【設定錯誤】\n請在程式碼中填入您的 LIFF ID！");
                return;
            }

            // 2. 檢查是否登入 (外部瀏覽器需要登入)
            if (!liff.isLoggedIn()) {
                liff.login(); // 會導向 LINE 登入頁面
                return;
            }

            // 3. 檢查環境是否支援分享
            if (liff.isApiAvailable('shareTargetPicker')) {
                try {
                    const res = await liff.shareTargetPicker([
                        {
                            type: "flex",
                            altText: "這是我媽媽的旅遊名片，推薦給您！",
                            contents: flexMessage
                        }
                    ]);
                    if (res) {
                        alert("名片已成功分享！");
                    } else {
                        // 使用者取消分享，不做動作或提示
                        console.log("分享已取消");
                    }
                } catch (error) {
                    console.log('分享失敗或取消', error);
                    // 不彈出 alert 避免干擾，除非是系統錯誤
                }
            } else {
                // 不支援的情況 (通常是電腦版瀏覽器某些模式，或 LINE 版本過舊)
                alert("此裝置或瀏覽器不支援「直接分享」功能。\n\n請嘗試：\n1. 將此網頁連結複製傳送到 LINE 聊天室中開啟。\n2. 或是使用手機版 LINE 開啟此連結。");
            }
        }
    </script>
</body>
</html>